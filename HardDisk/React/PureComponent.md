# React: 순수함수를 유지하라
일부 자바스크립트함수는 순수하다고 표현하는 경우가 있는데, 여기서 순수란 무슨의미일까?
순수함수는 계산만 수행하며 그 이상은 전혀 수행하지 않는 함수를 말합니다.
리액트 컴포넌트를 작성할 때, 순수함수로 작성하는 것이 유용한 이유는 전체적으로 프로젝트 커졌을 때, 이를 지켰다는 가정에서 유지보수에 용이하다는 것이다.

순수성 : 컴포넌트의 정석

컴퓨터 과학에서 순수함수의 기준은 2가지이다.
> 이 함수는 한가지 일만 하는 것이다.
> 같은 입력에는 같은 값을 반환해야한다.

만약 우리에게 숫자를 넣으면  *2 를 한 값을 반환하는 함수를 선언했다면,
내가 4를 백만번, 천만번, 억만번 넣어도 동일하게 8을 반환해야한다.
혹시라도 이 함수에 8이 아닌 다른 숫자가 나온다면?

이 함수는 결국 순수함수라고 보기에는 어려울 것이다.

리액트는 모든 컴포넌트가 결국은 이 순수성을 유지한다는 것을 가정하여 개발하는 것을 목적으로 합니다.

그래서 하나의 비유로 리액트 컴포넌트는 하나의 레시피로 비유한다.
레시피에 값을 넣게 된다면은 그에 맞는 결과가 맞게 음식, 즉 완성된 컴포넌트가 나오게 된다.
이 완성된 컴포넌트를 React는 렌더링 한다는 것이다.

## 사이드 이펙트
사이드 이펙트란 내가 예상하고 값을 넣었는데 예상과는 다른 결과물이 나왔을 경우, 개발자가 의도하지 않은 결과가 나오는 현상을 말합니다.

이에 대한 예시로 리액트 베타 문서에는 이런 예시가 있다.
```js
function Cup() {
  // Bad: changing a preexisting variable!
  guest = guest + 1;
  return <h2>Tea cup for guest #{guest}</h2>;
}

export default function TeaSet() {
  return (
    <>
      <Cup />
      <Cup />
      <Cup />
    </>
  )
}
```

이 코드만 보았을 때는 단순하게 저 `<Cup />`이라는 요소를 반복하니 guest의 값이 순서대로 1,2,3이 나올거라고 예상합니다.
하지만 결과값은 전혀 다른 2,4,6을 반환하게 됩니다.

만약 해당 Cup이 더 다양한 곳에서 선언되었다면? 저 guest값을 통제할 수단이 없기에 이 함수는 명백하게 리액트의 목적을 위반했다고 할 수 있습니다.

그렇다면 이를 통제하는 방법은 저 Cup 컴포넌트를 순수하게 만드는 것입니다.
함수의 목적을 명확하게 guest값에 따른 해당 h2태그를 출력하는 함수로 설정해본 상태에서 해당 코드를 고쳐보겠습니다.

```js
function Cup({guest) {
  return <h2>Tea cup for guest #{guest}</h2>;
}

export default function TeaSet() {
  return (
    <>
      <Cup guest={1}/>
      <Cup guest={2}/>
      <Cup guest={3}/>
    </>
  )
}
```

이렇게 작성된다면 우리가 의도한 1,2,3이 출력될 것입니다.

이렇게 저 Cup은 guest 값이라는 props에 의해서 의도된 결과를 출력하게 될 것입니다.


LocalMutation
이런 표현은 조금 낯설었다. 아무튼 이 내용에 대해서 설명하기이전에 Mutation의 개념은 무엇인가를 설명해보겠다.

> Mutation이란?
> 컴포넌트가 렌더링하는 동안 기존에 있던 변수를 변경하는 경우를 말한다.

그렇다면 LocalMutation은 무엇인가?
베타문서에서는 컴포넌트가 렌더링을 하는 과정에서 변수와 객체를 변경하는 작업이 이루어지는 과정을 LocalMutation이라고 합니다.

그렇다면 이러한 개념이 왜 중요한가? 
LocalMutation을 활용하게 되면 외부의 코드로 이러한 렌더링 처리가 이루어졌다는 사실을 전혀 알 수 없다는 것이 포인트입니다.
이를 하나의 Componetn Secret이라고 표현하기도 합니다.

## side effect를 일으키는 것
함수형 프로그래밍은 순수함수에 대해 크게 의존되지만,  어느시점에서는 값을 변경해야합니다.  이것이 side effect라고합니다. 
리액트에서 side effect는 일반적으로 이벤트 핸들러에 존재합니다. 이벤트 핸들러는 리액트에서 작업을 실행하는 함수입니다.물론 렌더링 중에는 이러한 내용이 발생하지는 않습니다.
따라서 이벤트 핸들러는 순수할 필요는 없습니다.

하지만 여기서 useEffect의 경우에는 다른 옵션들을 모두 사용하고 정말 올바른 이벤트 핸들러를 선택하지 못한 경우에 사용하는 최후의 보루로 사용하는 것이 좋다고 설명합니다.

가능하다면 렌더링은 개발자의 논리로써 되도록 선언하는 게 중요합니다.
