### 동기화 하드웨어

- **많은 시스템들은 임계 구역 코드를 위한 하드웨어 지원을 제공합니다**.
- **유니프로세서** – 인터럽트를 비활성화할 수 있습니다.
    - 현재 실행 중인 코드는 선점 없이 실행됩니다.
    - 일반적으로 멀티프로세서 시스템에서는 너무 비효율적입니다.
        - 이 방법을 사용하는 운영 체제는 광범위하게 확장 가능하지 않습니다.
- **현대의 기계들은 특별한 원자적 하드웨어 명령을 제공합니다**.
    - 원자적(Atomic) = 중단 불가능
    - 메모리 단어를 테스트하고 값을 설정하거나
    - 두 메모리 단어의 내용을 교환합니다.
    - RMW(읽기-수정-쓰기) 작업

### 잠금 구축

- **효율적인 잠금은 낮은 비용으로 상호 배제를 제공합니다**.
    - 잠금을 구축하려면 하드웨어와 OS의 도움이 필요합니다.
- **임계 구역을 실행할 때 인터럽트를 끄세요**.
- **임계 구역에 대한 인터럽트 비활성화**
    - 상호 배제를 제공하기 위해 사용된 초기 해결책 중 하나입니다.
    - 단일 프로세서 시스템을 위해 발명되었습니다.
    - 문제점:
        - 애플리케이션에 너무 많은 신뢰가 필요합니다.
            - 탐욕스러운(또는 악의적인) 프로그램이 프로세서를 독점할 수 있습니다.
        - 멀티프로세서에서 작동하지 않습니다 (멀티코어 시스템에서 코어 간 잠금을 지원하지 않음).
        - 여러 잠금을 지원하지 않습니다.
        - 하드웨어 인터럽트가 손실될 수 있습니다 (하드웨어는 인터럽트 X가 발생했다는 정보만 저장하고, 몇 번 발생했는지는 저장하지 않음).
        - 인터럽트를 마스킹하거나 해제하는 코드가 현대 CPU에서 느리게 실행될 수 있습니다.

### 동기화를 위한 하드웨어 지원

- **첫 시도**: 잠금이 보유되고 있는지 여부를 나타내는 플래그를 사용합니다.
    - 아래 코드에는 문제가 있습니다.
![[Pasted image 20240421181134.png]]